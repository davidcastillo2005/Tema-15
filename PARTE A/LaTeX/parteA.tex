%===================================================================================
% JORNADA CIENTÍFICA ESTUDIANTIL - MATCOM, UH
%===================================================================================
% Análisis Numérico y Cualitativo del Problema de Julio Verne: 
% Aceleración Gravitacional Variable
%===================================================================================

\documentclass[a4paper,10pt,twocolumn]{article}

%===================================================================================
% Paquetes
%===================================================================================
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[spanish]{babel}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{caption}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{array}

% Cargar el estilo jcematcom
\usepackage{jcematcom}

% Configuración de hyperref
\hypersetup{
    colorlinks=true,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=blue,
    pdftitle={Análisis Problema Julio Verne},
    pdfauthor={Autores}
}

%===================================================================================
% Presentación
%===================================================================================
\title{Análisis Numérico y Cualitativo del Problema de Julio Verne: \\ Aceleración Gravitacional Variable}

\author{Patricia Conde Lorente\\
Grupo C212
}

% Headings
\ShortHeadings{Análisis Problema Julio Verne}{Autores}

%===================================================================================
% DOCUMENTO
%===================================================================================
\begin{document}

\twocolumn[
\maketitle

%===================================================================================
% Resumen y Abstract
%===================================================================================

\begin{abstract}
Se realiza un análisis numérico completo del problema de Julio Verne sobre aceleración gravitacional variable, donde un proyectil es atraído simultáneamente por la Tierra y la Luna. Se evalúa la condición del problema, se implementan y comparan cuatro algoritmos numéricos (RK4, Verlet, Heun, Euler), se realiza análisis de error y se determina el orden de convergencia. Los resultados muestran alta sensibilidad cerca del punto de equilibrio y superioridad de métodos de orden superior.
\end{abstract}

\vspace{0.5cm}

\begin{enabstract}
A complete numerical analysis of Jules Verne's problem on variable gravitational acceleration is performed, where a projectile is simultaneously attracted by the Earth and the Moon. The problem's condition is evaluated, four numerical algorithms (RK4, Verlet, Heun, Euler) are implemented and compared, error analysis is performed, and the order of convergence is determined. Results show high sensitivity near the equilibrium point and superiority of higher-order methods.
\end{enabstract}

\begin{keywords}
EDO, Gravitación, Análisis Numérico, Sensibilidad, Orden de Convergencia
\end{keywords}

\begin{topics}
Ecuaciones Diferenciales, Mecánica Celeste, Análisis Numérico
\end{topics}

\vspace{0.8cm}
]

%===================================================================================
% Introducción y Formulación del Problema
%===================================================================================
\section{Problema de Julio Verne e isoclinas}

El problema de Julio Verne describe el movimiento de un proyectil lanzado desde la Tierra hacia la Luna, sujeto a atracción gravitacional de ambos cuerpos, donde la ecuación fundamental que representa este sistema es:

\begin{equation}
\frac{d^2r}{dt^2} = -\frac{GM_e}{r^2} + \frac{GM_m}{(S-r)^2}, \quad r(0) = R, \quad r'(0) = v_0
\end{equation}

donde en la resolución del mismo se tomarán como datos constantes:
\begin{itemize}
\item $M_e$ masa de la Tierra ($\approx 5.972 \times 10^{24}$ kg)
\item $M_m$: masa de la Luna ($\approx 7.384 \times 10^{22}$ kg)
\item $R$: radio terrestre ($\approx 6.371 \times 10^6$ m)
\item $S$: distancia Tierra-Luna ($\approx 3.844 \times 10^8$ m)
\item $v_0$: velocidad inicial crítica
\end{itemize}

%===================================================================================
% Análisis Numérico
%===================================================================================
\subsection{Resolución Analítica}

El problema se reduce a determinar la energía mínima necesaria para que el proyectil escape del dominio gravitatorio terrestre y alcance el dominio gravitatorio lunar. Para ello es fundamental identificar el punto donde la aceleración neta se anula. Definimos $r_{\mathrm{eq}}$ como la posición que satisface
\[
-\frac{G M_{e}}{r_{\mathrm{eq}}^{2}} 
+ \frac{G M_{m}}{(S-r_{\mathrm{eq}})^{2}}
= 0,
\]
Para que el proyectil logre superar esta barrera, basta con exigir que alcance $r_{\mathrm{eq}}$ con velocidad nula. Esta condición caracteriza la energía mínima requerida por el sistema.

El movimiento está gobernado por una fuerza conservativa, ya que proviene del potencial gravitatorio combinado
\[
U(r) = -\,G\!\left(\frac{M_{e}}{r} + \frac{M_{m}}{S-r}\right).
\]
La energía mecánica total se conserva:
\[
E = \tfrac{1}{2} v^{2} + U(r).
\]
Evaluando en el punto de partida $r=R$ y en el punto de equilibrio, e imponiendo que $v(r_{\mathrm{eq}})=0$, se obtiene
\[
\tfrac{1}{2} v_{0}^{2} + U(R) = U(r_{\mathrm{eq}}).
\]
Despejando la velocidad mínima de lanzamiento:
\[
v_{0}
= \sqrt{\,2\bigl[\,U(r_{\mathrm{eq}})-U(R)\,\bigr]\,}
\]
\[
v_{0} = \sqrt{2G\!\left[
M_{e}\!\left(\frac{1}{R}-\frac{1}{r_{\mathrm{eq}}}\right)
+ M_{m}\!\left(\frac{1}{S-R}-\frac{1}{S-r_{\mathrm{eq}}}\right)
\right]}
\]
Sustituyendo los valores numéricos estándar de $G$, $M_e$, $M_m$, $R$ y $S$, se obtiene
\[
v_{0} \approx 1.10723\times10^{4}\,\text{m/s}
= 11072.3 \,\text{m/s}.
\]

%===================================================================================
% Análisis Numérico
%===================================================================================
\subsection{Análisis Numérico}

\subsubsection{Análisis de la Condición del Problema}

Para analizar la condición del problema, un análisis teórico inicial de la EDO sugiere un comportamiento diferenciado para cada parámetro inicial: la velocidad inicial $v_0$ y la posición inicial $r_0$.

La transformación de la ecuación a:
\begin{equation}
v\frac{dv}{dr} = \frac{GM_e}{r^2} + \frac{GM_m}{(S-r)^2}
\end{equation}
revela que cuando $v \to 0$, la derivada $\frac{dv}{dr} = \frac{F(r)}{v}$ tiende a infinito, sugiriendo regiones de alta sensibilidad numérica. Para cuantificar esta sensibilidad, se recurrió al análisis de la matriz de evolución $\Phi(t)$ del sistema variacional.

La solución del sistema variacional proporciona la matriz de evolución:
\[
\Phi(t_{\text{eq}}) = \begin{pmatrix}
1.23 & 1820.57 \\
0.004 & 2450.12
\end{pmatrix}
\]
con número de condición $\kappa = \max \|\Phi(t)\| = 2850$.

Los elementos de $\Phi(t)$ confirman cuantitativamente el comportamiento esperado:

\begin{itemize}
\item \textbf{Bajo condicionamiento respecto a $r_0$}: $\phi_{11} \approx 1$ y $\phi_{21} \approx 0$ indican que perturbaciones en la posición inicial tienen efectos acotados en la solución.
\item \textbf{Alto condicionamiento respecto a $v_0$}: $\phi_{12} = 1820.57$ y $\phi_{22} = 2450.12$ muestran que pequeñas perturbaciones en la velocidad inicial se amplifican significativamente.
\end{itemize}

\subsubsection{Implementación y Comparación de Algoritmos}

En la resolución de la EDO de segundo orden se utilizaron cuatro metodos numéricos: Runge-Kutta de cuarto orden, Heun, Euler, Verlet. 
Para los pasos h = 1, h = 5, h = 10, h = 100, se computaron los métodos mencionados y se llegaron a los siguientes resultados mostrados en los Cuadros 1 y 2.
\begin{table}[h!]
\centering
\caption{Valores de la solución para diferentes tamaños de paso (Parte 1)}
\label{tab:solucion1}
\begin{tabular}{lcc}
\toprule
 & RK4 & Verlet \\
\midrule
h=1 & 11069.50311 & 11069.51058 \\
h=5 & 11069.50311 & 11069.58525 \\
h=10 & 11069.50311 & 11069.8242 \\
h=100 & 11069.62259 & 11101.21664 \\
\bottomrule
\end{tabular}
\end{table}

\begin{table}[h!]
\centering
\caption{Valores de la solución para diferentes tamaños de paso (Parte 2)}
\label{tab:solucion2}
\begin{tabular}{lcc}
\toprule
 & Heun & Euler \\
\midrule
h=1 & 11069.50311 & 11072.3929 \\
h=5 & 11069.58538 & 11083.9971 \\
h=10 & 11069.71966 & 11098.5732 \\
h=100 & 11091.42704 & 11376.5426 \\
\bottomrule
\end{tabular}
\end{table}



Se observa que RK4 mantiene consistencia desde el inicio, convergiendo incluso con $h=100$, mientras que los demás métodos son imprecisos con pasos grandes y van convergiendo conforme disminuye el tamaño del paso. Euler muestra la mayor desviación, especialmente con pasos grandes.




Para realizar el análisis de los errores relativos, se toma como solución exacta la obtenida mediante el método análitico $v_0$ = $11072.3 m/s$ 

\begin{table}[h!]
\centering
\caption{Errores relativos de los métodos (Parte 1)}
\label{tab:errores1}
\begin{tabular}{lcc}
\toprule
 & RK4 & Verlet \\
\midrule
h=1 & $2.526\times 10^{-4}$ & $2.519\times 10^{-4}$ \\
h=5 & $2.526\times 10^{-4}$ & $2.452\times 10^{-4}$ \\
h=10 & $2.526\times 10^{-4}$ & $2.236\times 10^{-4}$ \\
h=100 & $2.418\times 10^{-4}$ & $2.612\times 10^{-3}$ \\
\bottomrule
\end{tabular}
\end{table}

\begin{table}[h!]
\centering
\caption{Errores relativos de los métodos (Parte 2)}
\label{tab:errores2}
\begin{tabular}{lcc}
\toprule
 & Heun & Euler \\
\midrule
h=1 & $2.526\times 10^{-4}$ & $8.395\times 10^{-6}$ \\
h=5 & $2.479\times 10^{-4}$ & $1.056\times 10^{-3}$ \\
h=10 & $2.330\times 10^{-4}$ & $2.373\times 10^{-3}$ \\
h=100 & $1.727\times 10^{-3}$ & $2.748\times 10^{-2}$ \\
\bottomrule
\end{tabular}
\end{table}

Como es posible observar en los Cuadros 3 y 4, para pasos pequeños ($h=1$) todos los métodos presentan errores del mismo orden de magnitud, pero para pasos grandes ($h=100$) Euler muestra el error más significativo, seguido por Verlet y Heun, mientras que RK4 mantiene un error bajo y consistente.

\subsection{Orden de Convergencia y Complejidad Computacional}

El orden de convergencia de cada método indica cómo disminuye el error al reducir el tamaño de paso, para los métodos estudiados:

\begin{table}[h!]
\centering
\caption{Orden}
\label{tab:orden_convergencia}
\begin{tabular}{lc}
\toprule
Método & Orden \\
\midrule
Euler & 1 \\
Heun & 2 \\
Verlet & 2 \\
RK4 & 4 \\
\bottomrule
\end{tabular}
\end{table}

En cuanto a la complejidad computacional, todos los métodos requieren un número lineal de iteraciones respecto al tiempo total simulado, por lo que su complejidad es $O(n)$. Sin embargo, el costo por iteración sí cambia entre métodos, ya que depende del número de evaluaciones de la función necesaria en cada paso.

\begin{table}[h!]
\centering
\caption{Costo computacional por iteración}
\label{tab:costo_iteracion}
\begin{tabular}{lc}
\toprule
Método & Evaluaciones \\
\midrule
Euler & 1 \\
Heun & 2 \\
Verlet & 1 \\
RK4 & 4 \\
\bottomrule
\end{tabular}
\end{table}

En consecuencia, métodos como Euler o Verlet resultan más ligeros computacionalmente, mientras que RK4 ofrece mayor precisión a costa de un mayor número de evaluaciones por paso.


\subsubsection{Análisis de Estabilidad}

A la hora de realizar el análisis hacia adelante, se perturba el dato inicial $r_0$ y observando los resultados que proporcionan los diferentes métodos utilizando un tamaño de paso relativamente pequeño $h=1$. 

\begin{table}[h!]
\centering
\caption{Sensibilidad a perturbaciones en $r_0$ (h=1)}
\label{tab:forward_r0}
\begin{tabular}{lcccc}
\toprule
$r_0$ (m) & RK4 & Verlet & Heun & Euler \\
\midrule
6,371,000 & 11069.50 & 11069.51 & 11072.39 & 11072.39 \\
6,571,000 & 10896.14 & 10896.14 & 10896.14 & 10898.85 \\
6,771,000 & 10730.44 & 10730.44 & 10730.44 & 10733.00 \\
\bottomrule
\end{tabular}
\end{table}

De los resultados que se muestran en el Cuadro 5, se obtiene que Euler muestra un error sistemático de aproximadamente +2.89 para $r_0 = R$, mientras que los métodos en general no son muy sensibles ante variaciones en este parámetro. 

\begin{table}[h!]
\centering
\caption{Sensibilidad a perturbaciones en $v_0$ (h=1)}
\label{tab:forward_v0}
\begin{tabular}{lc}
\toprule
$v_0$ (m/s) & ¿Alcanza la Luna? \\
\midrule
11000 & No (todos los métodos) \\
11070 & Sí (RK4, Verlet, Heun), No (Euler) \\
11072 & Sí (RK4, Verlet, Heun), No (Euler) \\
\bottomrule
\end{tabular}
\end{table}

Para perturbaciones en $v_0$ se observa un comportamiento crítico: Euler falla en predecir correctamente la transición cerca del valor crítico, mientras que RK4, Verlet y Heun mantienen coherencia en sus predicciones.


Para realizar el análisis hacia atrás, se evaluó la estabilidad numérica de los algoritmos mediante la comparación entre el resultado obtenido y la solución que se habría calculado con datos ligeramente perturbados. 

\begin{table}[h!]
\centering
\begin{tabular}{lcccc}
\toprule
\textbf{Método} & \textbf{$h = 1$} & \textbf{$h = 5$} & \textbf{$h = 10$} & \textbf{$h = 100$} \\
\midrule
Euler & 3.418 & -0.488 & 2.441 & -1.465 \\
Heun & 4.395 & 2.441 & -2.441 & 2.441 \\
Verlet & -3.418 & -0.488 & 1.465 & -2.441 \\
RK4 & 1.465 & 1.465 & 1.465 & -3.418 \\
\bottomrule
\end{tabular}
\end{table}

Los valores de \( |\Delta r| < 5 \, \text{m} \) demuestran que el problema es \textbf{estable respecto a perturbaciones en la posición inicial}. La jerarquía de estabilidad, basada en la magnitud de \( \Delta r \), es:

\[
\text{RK4} > \text{Verlet} \approx \text{Heun} > \text{Euler} 
\]

confirmando que el método RK4 presenta la menor sensibilidad a variaciones en las condiciones iniciales.



%===================================================================================
% Análisis Cualitativo mediante Isoclinas
%===================================================================================
\subsection{Análisis Cualitativo mediante Isoclinas}

A partir de un modelo unidimensional del movimiento radial, se analiza el comportamiento cualitativo del sistema mediante el trazado del campo de isoclinas asociado a la ecuación diferencial del movimiento, con el objetivo de identificar regiones de estabilidad o inestabilidad, así como la sensibilidad del sistema ante perturbaciones iniciales.

Considerando ahora la expresión:
$f(r,v)=\frac{\frac{-GM_e}{r^2}+\frac{GM_m}{(S-r)^2}}{v}$ 
Se genera el campo de isoclinas (Fig. 1), representando las pendientes $\frac{dv}{dr}$ en cada punto del plano. 

El patrón cualitativo de las trayectorias muestra un comportamiento dominado por dos regiones de atracción gravitatoria determinadas por cada uno de los términos de la ecuación: uno cerca de la Tierra, y otra cerca de la Luna.

\begin{figure}[h!]
\centering
\includegraphics[width=0.9\linewidth]{isoclines.png}
\caption{Campo de isoclinas correspondiente al movimiento radial en el sistema Tierra–Luna.}
\label{fig:isoclinas}
\end{figure}

A partir del campo de direcciones, pueden distinguirse tres zonas de gran relevancia:
\begin{enumerate}
\item \textbf{Eje $v$}: Dado que el término $\frac{1}{v}$ en la ecuación se dispara cuando $v\approx$ 0, la región tiene un comportamiento inestable, es decir, variaciones en $v$ generan cambios bruscos de pendiente. Para $v>0$ las pendientes son negativas y para $v<0$ positivas, lo que corresponde a puntos de retorno o colisión donde la dinámica del sistema cambia abruptamente.
\item \textbf{Cercano al eje $r$}: Corresponde a la zona de influencia gravitatoria terrestre. Posee una alta sensibilidad respecto a $v$, observándose en los cambios bruscos de la dirección de las pendientes.
\item \textbf{Línea vertical $r=r_e$}: En el punto de equilibrio, donde las atracciones de la Tierra y la Luna se compensan, el sistema actúa como un umbral energético. Si la velocidad inicial es apenas positiva, se desplaza hacia la Luna; si es apenas negativa, regresa hacia la Tierra. Este comportamiento refleja una inestabilidad inherente a las variaciones de $v$.
\end{enumerate}

En el resto del campo, las pendientes son prácticamente horizontales, lo que indica que la variación de $v$ respecto a $r$ es mínima. En estas regiones, la aceleración neta es casi nula y se mantiene la velocidad con poca variación, reflejando un comportamiento estable. 

Podemos corroborar estas observaciones cualitativas a partir de las \textbf{isoclinas} del sistema. Para ello, se trazan las curvas correspondientes a las pendientes $k = 1$, $k = -1$, $k = 5$, $k = -5$, $k = 0.5$, $k = -0.5$, $k = 0$ y pendiente infinita. Con el fin de facilitar el análisis, se dividen en \textbf{isoclinas positivas y negativas}, dejando como casos particulares a $k = 0$ y a la pendiente infinita. 
Este análisis confirma los hallazgos del campo de pendientes: las \textbf{isoclinas positivas} aparecen principalmente cerca de la \textbf{influencia lunar}, donde la aceleración neta es positiva, favoreciendo un aumento de la velocidad.

\begin{figure}
    \centering
    \includegraphics[width=1.0\linewidth]{earth.png}
    \caption{Campo de isoclinas en la región del punto de equilibrio}
    \label{fig:placeholder}
\end{figure}
Las \textbf{negativas} dominan en la \textbf{región terrestre} (Fig 2), donde la aceleración es negativa; las isoclinas $k = 0$ y la de pendiente infinita representan, respectivamente, las condiciones $v = 0$ y $a = 0$, delimitando \textbf{transiciones entre ambos regímenes}. 

\begin{figure}
    \centering
    \includegraphics[width=1.0\linewidth]{stable.png}
    \caption{Campo de isoclinas en la región del punto de equilibrio}
    \label{fig:placeholder}
\end{figure}
Finalmente, en las proximidades del punto de equilibrio (Fig 3), las isoclinas se agrupan densamente y cambian de signo con rapidez, corroborando visualmente la alta sensibilidad y la inestabilidad que se infirió inicialmente a partir del campo de direcciones.

\label{end}

\end{document}